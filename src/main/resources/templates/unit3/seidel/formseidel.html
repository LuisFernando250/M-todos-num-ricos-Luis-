<!doctype html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>MÉTODOS NUMÉRICOS</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Bootstrap CSS -->
    <link
        href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
        rel="stylesheet">
    <!-- Bootstrap JS -->
    <script
        src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</head>

<script th:inline="javascript">
    function crearMatriz() {
        var MN = parseInt(document.getElementById('MN').value || '0', 10);
        var contA = document.getElementById('ContenedorMatriz');
        var contB = document.getElementById('ContenedorB');
        var contX0 = document.getElementById('ContenedorX0');
        contA.replaceChildren();
        contB.replaceChildren();
        contX0.replaceChildren();

        if (!MN || MN < 2 || MN > 4) {
            alert("Ingresa n entre 2 y 4.");
            return;
        }

        for (let i = 1; i <= MN; i++) {
            const rowA = document.createElement('div');
            rowA.className = "row";
            contA.appendChild(rowA);

            for (let j = 1; j <= MN; j++) {
                const colA = document.createElement('div');
                colA.className = "col";
                rowA.appendChild(colA);

                const aij = document.createElement('input');
                aij.type = 'text';
                aij.name = 'matrizA[]';       // A plana n*n
                aij.placeholder = 'a' + i + j;
                aij.className = "form-control mb-3";
                colA.appendChild(aij);
            }

            // b_i
            const rowB = document.createElement('div');
            rowB.className = 'row';
            contB.appendChild(rowB);

            const colB = document.createElement('div');
            colB.className = 'col';
            rowB.appendChild(colB);

            const bi = document.createElement('input');
            bi.type = 'text';
            bi.name = 'vectorB[]';           // B plano n
            bi.placeholder = 'b' + i;
            bi.className = 'form-control mb-3';
            colB.appendChild(bi);

            // x0_i opcional (condición inicial)
            const rowX0 = document.createElement('div');
            rowX0.className = 'row';
            contX0.appendChild(rowX0);

            const colX0 = document.createElement('div');
            colX0.className = 'col';
            rowX0.appendChild(colX0);

            const x0i = document.createElement('input');
            x0i.type = 'text';
            x0i.name = 'vectorX0[]';         // X0 plano n (si no lo llenan, el backend pondrá ceros)
            x0i.placeholder = 'x0_' + i + ' (opcional)';
            x0i.className = 'form-control mb-3';
            colX0.appendChild(x0i);
        }

        document.getElementById('resolver').style.display = 'block';
    }
</script>

<body>
<nav th:replace="/layout/template :: menu"></nav>
<div th:replace="/layout/template :: bannerunit2"></div>

<div class="container">
    <nav aria-label="breadcrumb" class="mt-2">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="/">Inicio</a></li>
            <li class="breadcrumb-item"><a href="/unit3">Sistemas Lineales</a></li>
            <li class="breadcrumb-item active" aria-current="page">Formulario - Gauss-Seidel</li>
        </ol>
    </nav>
</div>

<div class="container">
    <form class="row g-3" th:action="@{/unit3/solveseidel}" method="post" th:object="${seidel}">
        <div class="container">
            <h1 class="text">Método Iterativo: Gauss-Seidel</h1>
            <h3 class="text">Ingresa los parámetros siguientes:</h3>

            <div class="row">
                <div class="col-md-3">
                    <label for="MN" class="form-label"># Dimensión del sistema (n: 2–4)</label>
                    <!-- name="n" para bindear a seidel.n ; id="MN" para el script -->
                    <input type="text" class="form-control" id="MN" name="n" placeholder="3">
                </div>
                <div class="col-md-3">
                    <label for="TO" class="form-label">Tolerancia (To)</label>
                    <!-- name="to" para bindear a seidel.to -->
                    <input type="text" class="form-control" id="TO" name="to" placeholder="1e-8">
                </div>
                <div class="col-md-3">
                    <label for="IM" class="form-label">Iteraciones Máximas</label>
                    <!-- name="iteracionesMaximas" para bindear a seidel.iteracionesMaximas -->
                    <input type="text" class="form-control" id="IM" name="iteracionesMaximas" placeholder="100">
                </div>
                <div class="col-md-3 d-flex align-items-end">
                    <button type="button" class="btn btn-secondary" onclick="crearMatriz()">Crear Matriz</button>
                </div>
            </div>

            <div class="row mt-3">
                <div class='Contenedor text-center'>
                    <div class="row align-items-start">
                        <div class='col'>
                            <p class="fw-semibold">MATRIZ A</p>
                            <div id='ContenedorMatriz'></div>
                        </div>
                        <div class='col-3'>
                            <p class="fw-semibold">Vector B</p>
                            <div id='ContenedorB'></div>
                        </div>
                        <div class='col-3'>
                            <p class="fw-semibold">Vector X0 (opcional)</p>
                            <div id='ContenedorX0'></div>
                        </div>
                    </div>
                </div>

                <div id='resolver' class="p-2 row" style="display:none">
                    <div class="col-12">
                        <br>
                        <button type="submit" class="btn btn-primary">Resolver Sistema</button>
                    </div>
                </div>
            </div>
        </div>
    </form>
</div>
</body>
</html>
