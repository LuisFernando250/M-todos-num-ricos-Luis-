<!doctype html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>MÉTODOS NUMÉRICOS</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
</head>
<body>
<div class="container">
    <nav th:replace="/layout/template :: menu"></nav>
    <div th:replace="/layout/template :: bannerunit3"></div>

    <nav aria-label="breadcrumb" class="mt-3">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="/">Inicio</a></li>
            <li class="breadcrumb-item"><a href="/unit4">Ajuste de Curvas</a></li>
            <li class="breadcrumb-item active" aria-current="page">Solución - Lagrange</li>
        </ol>
    </nav>

    <div class="container">
        <h1 class="text">Polinomio de interpolación de Lagrange</h1>

        <!-- Resumen -->
        <div class="row mt-3">
            <div class="col-4"><span class="fw-semibold">n (puntos):</span></div>
            <div class="col-8"><span th:text="${#lists.last(solveLagrange).n}">0</span></div>
        </div>

        <!-- Puntos -->
        <div class="mt-3">
            <p class="fw-semibold">Puntos (x, y):</p>
            <div class="container">
                <div class="row" th:each="i : ${#numbers.sequence(0, #lists.last(solveLagrange).n - 1)}">
                    <div class="col">
                        <span th:text="'x'+(i+1)+': ' + ${#lists.last(solveLagrange).x[i]}">x</span>
                    </div>
                    <div class="col">
                        <span th:text="'y'+(i+1)+': ' + ${#lists.last(solveLagrange).y[i]}">y</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Polinomio -->
        <div class="row mt-3">
            <div class="col-4"><span class="fw-semibold">Polinomio (texto):</span></div>
            <div class="col-8"><span th:text="${#lists.last(solveLagrange).polinomio}">P(x)</span></div>
        </div>

        <!-- Evaluación opcional -->
        <div class="mt-3" th:if="${#lists.last(solveLagrange).evalX != null}">
            <p class="fw-semibold">Evaluación</p>
            <div class="container">
                <div class="row" th:each="i : ${#numbers.sequence(0, #lists.last(solveLagrange).evalX.length - 1)}">
                    <div class="col">
                        <span th:text="'x = ' + ${#lists.last(solveLagrange).evalX[i]}">xq</span>
                    </div>
                    <div class="col">
                        <span th:text="'P(x) = ' + ${#lists.last(solveLagrange).evalY[i]}">P(xq)</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Pasos (si agregaste pasos en el servicio) -->
        <div class="mt-4" th:if="${#lists.size(solveLagrange) > 1}">
            <h5>Pasos</h5>
            <div class="accordion" id="accLag">
                <div class="accordion-item" th:each="ren,idx : ${solveLagrange}">
                    <h2 class="accordion-header" th:attr="id=${'h-'+idx.index}">
                        <button class="accordion-button collapsed" type="button"
                                data-bs-toggle="collapse"
                                th:attr="data-bs-target=${'#c-'+idx.index}"
                                aria-expanded="false"
                                th:attr="aria-controls=${'c-'+idx.index}">
                            <span th:text="${(ren.pasos != null && ren.pasos.length>0)? ren.pasos[0] : 'Paso ' + (idx.index+1)}">Paso</span>
                        </button>
                    </h2>
                    <div class="accordion-collapse collapse"
                         th:attr="id=${'c-'+idx.index}"
                         th:attrappend="aria-labelledby=${'h-'+idx.index}"
                         data-bs-parent="#accLag">
                        <div class="accordion-body">
                            <div th:if="${ren.coef != null}">
                                <p class="fw-semibold">Coeficientes parciales:</p>
                                <code th:text="${#strings.arrayJoin(ren.coef, ', ')}">c0, c1, ...</code>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="my-4">
            <a class="btn btn-secondary" href="/unit4/formlagrange">Nueva interpolación</a>
        </div>
    </div>
</div>
</body>
</html>
