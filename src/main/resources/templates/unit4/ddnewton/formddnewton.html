<!doctype html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
  <title>MÉTODOS NUMÉRICOS</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
        rel="stylesheet" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
          crossorigin="anonymous"></script>
</head>

<script th:inline="javascript">
  function crearTabla() {
    var ord = parseInt(document.getElementById('ORD').value || '0');
    if (isNaN(ord) || ord < 1 || ord > 4) {
      alert('El orden debe ser 1, 2, 3 o 4');
      return;
    }
    var n = ord + 1; // número de puntos
    document.getElementById('NHidden').value = n;

    var contX = document.getElementById('ContenedorX');
    var contY = document.getElementById('ContenedorY');
    contX.replaceChildren();
    contY.replaceChildren();

    for (let i = 1; i <= n; i++) {
      var rX = document.createElement('div');
      rX.className = 'row';
      var cX = document.createElement('div');
      cX.className = 'col';
      var inX = document.createElement('input');
      inX.type = 'text';
      inX.name = 'x[]';
      inX.placeholder = 'x' + i;
      inX.className = 'form-control mb-2';
      cX.appendChild(inX);
      rX.appendChild(cX);
      contX.appendChild(rX);

      var rY = document.createElement('div');
      rY.className = 'row';
      var cY = document.createElement('div');
      cY.className = 'col';
      var inY = document.createElement('input');
      inY.type = 'text';
      inY.name = 'y[]';
      inY.placeholder = 'y' + i;
      inY.className = 'form-control mb-2';
      cY.appendChild(inY);
      rY.appendChild(cY);
      contY.appendChild(rY);
    }

    var k = parseInt(document.getElementById('NUMEVAL').value || '0');
    var contE = document.getElementById('ContenedorEval');
    contE.replaceChildren();
    if (!isNaN(k) && k > 0) {
      for (let j = 1; j <= k; j++) {
        var rE = document.createElement('div');
        rE.className = 'row';
        var cE = document.createElement('div');
        cE.className = 'col';
        var inE = document.createElement('input');
        inE.type = 'text';
        inE.name = 'evalX[]';
        inE.placeholder = 'x_eval ' + j;
        inE.className = 'form-control mb-2';
        cE.appendChild(inE);
        rE.appendChild(cE);
        contE.appendChild(rE);
      }
    }

    document.getElementById('resolver').style.display = 'block';
  }
</script>

<body>
  <nav th:replace="/layout/template :: menu"></nav>
  <div th:replace="/layout/template :: bannerunit2"></div>

  <div class="container">
    <nav aria-label="breadcrumb" class="mt-2">
      <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="/">Inicio</a></li>
        <li class="breadcrumb-item"><a href="/unit4">Ajuste de Curvas</a></li>
        <li class="breadcrumb-item active" aria-current="page">Formulario - DD Newton</li>
      </ol>
    </nav>
  </div>

  <div class="container">
    <form class="row g-3" th:action="@{/unit4/solveddnewton}" method="post" th:object="${ddnewton}">
      <div class="container">
        <h1 class="text">Diferencias Divididas de Newton</h1>
        <h3 class="text">Ingresa los parámetros siguientes:</h3>

        <div class="row">
          <div class="col-md-3">
            <label for="ORD" class="form-label">Orden del polinomio (1–4)</label>
            <input type="number" min="1" max="4" class="form-control" id="ORD" placeholder="3">
          </div>
          <div class="col-md-3">
            <label for="NUMEVAL" class="form-label"># de puntos a evaluar (opcional)</label>
            <input type="number" min="0" class="form-control" id="NUMEVAL" placeholder="0">
          </div>
          <div class="col-md-3 d-flex align-items-end">
            <button type="button" class="btn btn-secondary" onclick="crearTabla()">Crear Tabla</button>
          </div>
        </div>

        <!-- Campo oculto que bindea con ddnewton.n -->
        <input type="hidden" id="NHidden" name="n" value="0"/>

        <div class="row mt-3">
          <div class="col">
            <p class="fw-semibold">X</p>
            <div id="ContenedorX"></div>
          </div>
          <div class="col">
            <p class="fw-semibold">Y</p>
            <div id="ContenedorY"></div>
          </div>
          <div class="col-3">
            <p class="fw-semibold">Evaluar en (opcional)</p>
            <div id="ContenedorEval"></div>
          </div>
        </div>

        <div id="resolver" class="row" style="display:none">
          <div class="col-12">
            <button type="submit" class="btn btn-primary mt-3">Calcular</button>
          </div>
        </div>
      </div>
    </form>
  </div>
</body>
</html>
